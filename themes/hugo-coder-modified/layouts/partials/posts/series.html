{{ $currentPageUrl := .RelPermalink }}
{{ if .Params.series }}
<div class="see-also">
  {{ range .Params.series }}
    {{ $name := . | urlize }}
    {{ $series := index $.Site.Taxonomies.series $name }}
    {{ if gt (len $series.Pages) 1 }}

      <!-- section modified to better display the read latest posts section: -->
      <h2 id="{{ i18n "read_next" | default "READ NEXT:" | anchorize }}-{{ anchorize . | safeURL }}">
        {{ i18n "read_next" | default "READ NEXT:" }}
        <a class="heading-link" href="#{{ i18n "read_next" | default "READ NEXT:" | anchorize }}-{{ anchorize . | safeURL }}">
          <i class="fa fa-link" aria-hidden="true"></i>
        </a>
      </h2>
      <nav class="list">
        <ul>
        {{ $maxItems := $.Site.Params.maxSeeAlsoItems | default 5 }}
        {{ range first (add $maxItems 1) $series.Pages }}
          {{ if ne .RelPermalink $currentPageUrl }}
            <li>
              <span class="date">{{ .Date.Format (.Site.Params.dateFormat | default "January 2, 2006" ) }}</span>
              <a class="title" href="{{ .Params.externalLink | default .RelPermalink }}">{{ .Title }}</a>
              <span class="tag">{{ with .Page.Params.Tags }}{{ partial "taxonomy/tags.html" . }}{{ end }}</span>
            </li>
          {{ end }}
        {{ end }}
        </ul>
      </nav>

    {{ end }}
  {{ end }}
</div>
{{ end }}
